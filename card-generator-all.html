<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé¥ Card Generator - All Cards View</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Kanit', sans-serif;
            background: linear-gradient(135deg, #1a1d29 0%, #2d3748 100%);
            min-height: 100vh;
            padding: 20px;
            color: #fff;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #ffd700 0%, #ff8c42 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        #connectionStatus {
            display: inline-block;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .main-layout {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 30px;
        }

        .cards-preview {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            align-items: start;
        }
        
        .character-row,
        .skills-row {
            align-self: start;
        }

        .character-row {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            height: 100%;
        }

        .skills-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            grid-template-rows: repeat(2, 1fr);
            gap: 15px;
        }

        .card-wrapper {
            background: #2d3748;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            text-align: center;
        }

        .card-wrapper.character {
            width: 100%;
            height: 100%;
        }

        .card-wrapper canvas {
            border-radius: 10px;
            max-width: 100%;
            height: auto;
            box-shadow: 0 8px 20px rgba(0,0,0,0.4);
        }

        .card-label {
            font-size: 14px;
            color: #ffd700;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .download-btn {
            margin-top: 10px;
            padding: 8px 16px;
            background: linear-gradient(135deg, #ffd700 0%, #ff8c42 100%);
            border: none;
            border-radius: 8px;
            color: #000;
            font-family: 'Kanit', sans-serif;
            font-weight: 600;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255,215,0,0.4);
        }

        .controls-panel {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.4);
            border: 1px solid rgba(255,255,255,0.1);
            max-height: calc(100vh - 100px);
            overflow-y: auto;
        }

        /* Hide scrollbar but keep functionality */
        .controls-panel::-webkit-scrollbar {
            width: 8px;
        }

        .controls-panel::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
        }

        .controls-panel::-webkit-scrollbar-thumb {
            background: rgba(255,215,0,0.3);
            border-radius: 10px;
        }

        .controls-panel::-webkit-scrollbar-thumb:hover {
            background: rgba(255,215,0,0.5);
        }

        .section-title {
            font-size: 1.3rem;
            margin-bottom: 20px;
            color: #ffd700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tab-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 10px 20px;
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 10px;
            color: #fff;
            font-family: 'Kanit', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 13px;
            text-decoration: none;
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #ffd700 0%, #ff8c42 100%);
            color: #000;
            border-color: #ffd700;
        }

        .tab-btn:hover:not(.active) {
            background: rgba(255,255,255,0.2);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: #ffd700;
            font-size: 13px;
            text-decoration: none;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 2px solid rgba(255,255,255,0.2);
            background: rgba(255,255,255,0.1);
            color: #fff;
            font-family: 'Kanit', sans-serif;
            font-size: 13px;
            transition: all 0.3s ease;
        }

        .form-group select option {
            background: #2d3748;
            color: #ffffff;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #ffd700;
            background: rgba(255,255,255,0.15);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
        }

        .image-upload-zone {
            border: 2px dashed rgba(255,215,0,0.5);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(255,215,0,0.05);
            font-size: 12px;
            user-select: none;
        }

        .image-upload-zone:hover {
            border-color: #ffd700;
            background: rgba(255,215,0,0.1);
        }

        .image-upload-zone.has-image {
            border-color: #48bb78;
            background: rgba(72,187,120,0.1);
        }

        .upload-icon {
            font-size: 32px;
            margin-bottom: 5px;
        }

        .image-preview {
            max-width: 150px;
            max-height: 150px;
            margin: 10px auto;
            border-radius: 8px;
            display: none;
        }

        .image-preview.show {
            display: block;
        }

        .image-controls {
            display: none;
            gap: 8px;
            margin-top: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .image-controls.show {
            display: flex;
        }

        .slider-group {
            margin-top: 8px;
        }

        .slider-group label {
            font-size: 11px;
            color: #a0aec0;
        }

        .slider-group input[type="range"] {
            width: 100%;
            margin-top: 3px;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 11px;
            border-radius: 6px;
            border: none;
            font-family: 'Kanit', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: #fff;
            border: 2px solid rgba(255,255,255,0.3);
        }

        .btn-secondary:hover {
            background: rgba(255,255,255,0.2);
        }

        .btn-primary {
            background: linear-gradient(135deg, #ffd700 0%, #ff8c42 100%);
            color: #000;
        }

        .btn-save {
            background: linear-gradient(135deg, #4caf50 0%, #45a049 100%);
            color: #fff;
            border: none;
            border-radius: 8px;
            font-family: 'Kanit', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        }

        .btn-save:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.5);
            background: linear-gradient(135deg, #45a049 0%, #4caf50 100%);
        }

        .btn-save:active {
            transform: translateY(0);
        }

        .btn-block {
            width: 100%;
            padding: 12px;
            margin-top: 15px;
            font-size: 14px;
        }

        .char-count {
            font-size: 11px;
            color: #ffd700;
            margin-top: 5px;
        }

        @media (max-width: 1400px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
            
            .skills-row {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .skills-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé¥ Card Generator - ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h1>
            <p>‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£ + ‡∏™‡∏Å‡∏¥‡∏•‡∏ó‡∏±‡πâ‡∏á 4 ‡πÅ‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô</p>
            <div id="connectionStatus" style="margin-top: 10px; padding: 8px 16px; border-radius: 8px; font-size: 14px; font-weight: 600;">
                <span id="statusIcon">üîÑ</span>
                <span id="statusText">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...</span>
            </div>
        </div>

        <div class="main-layout">
            <!-- Cards Preview Section -->
            <div class="cards-preview">
                <!-- Character Card -->
                <div class="character-row">
                    <div class="card-wrapper character" onclick="document.getElementById('charImageInput').click()" style="cursor: pointer;">
                        <div class="card-label">üê≤ ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£ (‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ)</div>
                        <canvas id="characterCanvas" width="744" height="1039"></canvas>
                    </div>
                </div>

                <!-- Skill Cards (‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏° Energy: 0 ‚Üí 1 ‚Üí 2 ‚Üí 3) -->
                <div class="skills-row">
                    <div class="card-wrapper" onclick="document.getElementById('passImageInput').click()" style="cursor: pointer;">
                        <div class="card-label">üí´ Passive (‚ö°0) - ‡∏™‡∏Å‡∏¥‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡∏ß</div>
                        <canvas id="passiveCanvas" width="744" height="1039"></canvas>
                    </div>
                    <div class="card-wrapper" onclick="document.getElementById('normImageInput').click()" style="cursor: pointer;">
                        <div class="card-label">‚öîÔ∏è Normal (‚ö°1) - ‡∏™‡∏Å‡∏¥‡∏• 1</div>
                        <canvas id="normalCanvas" width="744" height="1039"></canvas>
                    </div>
                    <div class="card-wrapper" onclick="document.getElementById('suppImageInput').click()" style="cursor: pointer;">
                        <div class="card-label">üíö Support (‚ö°2) - ‡∏™‡∏Å‡∏¥‡∏• 2</div>
                        <canvas id="supportCanvas" width="744" height="1039"></canvas>
                    </div>
                    <div class="card-wrapper" onclick="document.getElementById('ultImageInput').click()" style="cursor: pointer;">
                        <div class="card-label">üî• Ultimate (‚ö°3) - ‡∏™‡∏Å‡∏¥‡∏•‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢</div>
                        <canvas id="ultimateCanvas" width="744" height="1039"></canvas>
                    </div>
                </div>
            </div>

            <!-- Controls Panel -->
            <div class="controls-panel">
                <h2 class="section-title">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡πå‡∏î</h2>

                <div class="tab-buttons">
                    <button class="tab-btn active" onclick="switchTab('character')">üê≤ ‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£</button>
                    <button class="tab-btn" onclick="switchTab('passive')">üí´ Passive</button>
                    <button class="tab-btn" onclick="switchTab('normal')">‚öîÔ∏è Normal</button>
                    <button class="tab-btn" onclick="switchTab('support')">üíö Support</button>
                    <button class="tab-btn" onclick="switchTab('ultimate')">üî• Ultimate</button>
                </div>

                <div style="margin-bottom: 20px; display: flex; gap: 10px; flex-direction: column;">
                    <button class="btn-save btn-block" onclick="saveToSystem()">
                        üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡∏£‡∏∞‡∏ö‡∏ö
                    </button>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn-primary" style="flex: 1; padding: 12px;" onclick="downloadCurrentCard()">
                            üíæ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏ô‡∏µ‡πâ
                        </button>
                        <button class="btn-primary" style="flex: 1; padding: 12px;" onclick="downloadAllCards()">
                            üì¶ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                        </button>
                    </div>
                </div>

                <!-- Character Tab -->
                <div id="tab-character" class="tab-content active">
                    <div class="form-group">
                        <label>üñºÔ∏è ‡∏£‡∏π‡∏õ‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£ (‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ)</label>
                        <input type="file" id="charImageInput" accept="image/*" style="display:none;">
                        <div class="image-controls" id="charImageControls" style="display:none;">
                            <div class="slider-group" style="width: 100%;">
                                <label>üîç ‡∏ã‡∏π‡∏°: <span id="charScaleValue">100%</span></label>
                                <input type="range" id="charScaleSlider" min="50" max="200" value="100" oninput="updateCharImage()">
                            </div>
                            <div class="slider-group" style="width: 100%;">
                                <label>‚ÜîÔ∏è ‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô: <span id="charXValue">0</span></label>
                                <input type="range" id="charXSlider" min="-200" max="200" value="0" oninput="updateCharImage()">
                            </div>
                            <div class="slider-group" style="width: 100%;">
                                <label>‚ÜïÔ∏è ‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á: <span id="charYValue">0</span></label>
                                <input type="range" id="charYSlider" min="-200" max="200" value="0" oninput="updateCharImage()">
                            </div>
                            <button class="btn-secondary btn-small" onclick="resetCharImage()">‚Ü∫ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
                            <button class="btn-secondary btn-small" onclick="removeCharImage()">üóëÔ∏è ‡∏•‡∏ö‡∏£‡∏π‡∏õ</button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>üî• ‡∏ò‡∏≤‡∏ï‡∏∏</label>
                        <select id="charElement" onchange="updateAllCards()">
                            <option value="fire">üî• ‡πÑ‡∏ü (Fire)</option>
                            <option value="water">üíß ‡∏ô‡πâ‡∏≥ (Water)</option>
                            <option value="earth">üåç ‡∏î‡∏¥‡∏ô (Earth)</option>
                            <option value="wind">üí® ‡∏•‡∏° (Wind)</option>
                            <option value="electric">‚ö° ‡∏™‡∏≤‡∏¢‡∏ü‡πâ‡∏≤ (Electric)</option>
                            <option value="ice">‚ùÑÔ∏è ‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á (Ice)</option>
                            <option value="dark">üåô ‡∏°‡∏∑‡∏î (Dark)</option>
                            <option value="light">‚òÄÔ∏è ‡πÅ‡∏™‡∏á (Light)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>üìù ‡∏ä‡∏∑‡πà‡∏≠‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢</label>
                        <input type="text" id="charNameThai" value="‡πÑ‡∏ü‡∏£‡πå‡∏î‡∏£‡∏≤‡∏Å‡πâ‡∏≠‡∏ô" oninput="updateAllCards()">
                    </div>

                    <div class="form-group">
                        <label>üìù ‡∏ä‡∏∑‡πà‡∏≠‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©</label>
                        <input type="text" id="charNameEng" value="FIRE DRAGON" oninput="updateAllCards()">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>‚ù§Ô∏è HP</label>
                            <input type="number" id="charHP" value="450" oninput="updateAllCards()">
                        </div>
                        <div class="form-group">
                            <label>‚öîÔ∏è ATK</label>
                            <input type="number" id="charATK" value="70" oninput="updateAllCards()">
                        </div>
                        <div class="form-group">
                            <label>‚ö° SPD</label>
                            <input type="number" id="charSPD" value="40" oninput="updateAllCards()">
                        </div>
                    </div>
                </div>

                <!-- Ultimate Tab -->
                <div id="tab-ultimate" class="tab-content">
                    <input type="file" id="ultImageInput" accept="image/*" style="display:none;">

                    <div class="form-group">
                        <label>üìù ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏Å‡∏¥‡∏•</label>
                        <input type="text" id="ultName" value="‡∏ô‡∏£‡∏Å‡πÄ‡∏û‡∏•‡∏¥‡∏á" oninput="updateAllCards()">
                    </div>

                    <div class="form-group">
                        <label>üìù ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 30 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£)</label>
                        <textarea id="ultDesc" rows="2" maxlength="30" oninput="validateDesc('ult')">‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡∏®‡∏±‡∏ï‡∏£‡∏π‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏õ‡∏•‡∏ß‡πÑ‡∏ü</textarea>
                        <div id="ultCharCount" class="char-count">0 / 30 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£</div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>‚öîÔ∏è ‡∏î‡∏≤‡πÄ‡∏°‡∏à</label>
                            <input type="number" id="ultDamage" value="200" oninput="updateAllCards()">
                        </div>
                        <div class="form-group">
                            <label>üõ°Ô∏è ‡πÇ‡∏•‡πà</label>
                            <input type="number" id="ultShield" value="0" oninput="updateAllCards()">
                        </div>
                        <div class="form-group">
                            <label>üíö ‡∏Æ‡∏µ‡∏•</label>
                            <input type="number" id="ultHeal" value="0" oninput="updateAllCards()">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>üéØ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</label>
                        <select id="ultTarget" onchange="updateAllCards()">
                            <option value="front">‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏∏‡∏î (Front)</option>
                            <option value="back">‡∏´‡∏•‡∏±‡∏á‡∏™‡∏∏‡∏î (Back)</option>
                            <option value="lowest">HP ‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î (Lowest HP)</option>
                            <option value="highest">HP ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î (Highest HP)</option>
                            <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (All)</option>
                            <option value="self">‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á (Self)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>üê≤ ‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á</label>
                        <select id="ultOwner" onchange="updateAllCards()">
                            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£ --</option>
                            <optgroup label="üî• ‡∏ò‡∏≤‡∏ï‡∏∏‡πÑ‡∏ü (Fire)">
                                <option value="‡πÑ‡∏ü‡∏£‡πå‡∏î‡∏£‡∏≤‡∏Å‡πâ‡∏≠‡∏ô">üê≤ ‡πÑ‡∏ü‡∏£‡πå‡∏î‡∏£‡∏≤‡∏Å‡πâ‡∏≠‡∏ô</option>
                                <option value="‡πÑ‡∏ü‡∏£‡πå‡∏ü‡πá‡∏≠‡∏Å‡∏ã‡πå">ü¶ä ‡πÑ‡∏ü‡∏£‡πå‡∏ü‡πá‡∏≠‡∏Å‡∏ã‡πå</option>
                            </optgroup>
                            <optgroup label="üíß ‡∏ò‡∏≤‡∏ï‡∏∏‡∏ô‡πâ‡∏≥ (Water)">
                                <option value="‡∏ß‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ï‡∏≠‡∏£‡πå‡∏ó‡∏≠‡∏¢‡∏™‡πå">üê¢ ‡∏ß‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ï‡∏≠‡∏£‡πå‡∏ó‡∏≠‡∏¢‡∏™‡πå</option>
                                <option value="‡∏ß‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏≠‡∏≠‡∏Ñ‡πÇ‡∏ó‡∏õ‡∏±‡∏™">üêô ‡∏ß‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏≠‡∏≠‡∏Ñ‡πÇ‡∏ó‡∏õ‡∏±‡∏™</option>
                            </optgroup>
                            <optgroup label="üåç ‡∏ò‡∏≤‡∏ï‡∏∏‡∏î‡∏¥‡∏ô (Earth)">
                                <option value="‡πÄ‡∏≠‡∏¥‡∏£‡πå‡∏ò‡πÑ‡∏£‡πÇ‡∏ô">ü¶è ‡πÄ‡∏≠‡∏¥‡∏£‡πå‡∏ò‡πÑ‡∏£‡πÇ‡∏ô</option>
                                <option value="‡πÄ‡∏≠‡∏¥‡∏£‡πå‡∏ò‡∏ö‡∏π‡∏•‡∏•‡πå">üêÇ ‡πÄ‡∏≠‡∏¥‡∏£‡πå‡∏ò‡∏ö‡∏π‡∏•‡∏•‡πå</option>
                            </optgroup>
                            <optgroup label="üí® ‡∏ò‡∏≤‡∏ï‡∏∏‡∏•‡∏° (Wind)">
                                <option value="‡∏ß‡∏¥‡∏ô‡∏î‡πå‡∏≠‡∏µ‡πÄ‡∏Å‡∏¥‡∏•">ü¶Ö ‡∏ß‡∏¥‡∏ô‡∏î‡πå‡∏≠‡∏µ‡πÄ‡∏Å‡∏¥‡∏•</option>
                                <option value="‡∏ß‡∏¥‡∏ô‡∏î‡πå‡∏Æ‡∏≠‡∏ß‡πå‡∏Ñ">ü¶ú ‡∏ß‡∏¥‡∏ô‡∏î‡πå‡∏Æ‡∏≠‡∏ß‡πå‡∏Ñ</option>
                            </optgroup>
                            <optgroup label="‚ö° ‡∏ò‡∏≤‡∏ï‡∏∏‡∏™‡∏≤‡∏¢‡∏ü‡πâ‡∏≤ (Electric)">
                                <option value="‡πÑ‡∏•‡∏ó‡πå‡∏ô‡∏¥‡πà‡∏á‡πÑ‡∏ó‡πÄ‡∏Å‡∏≠‡∏£‡πå">üêØ ‡πÑ‡∏•‡∏ó‡πå‡∏ô‡∏¥‡πà‡∏á‡πÑ‡∏ó‡πÄ‡∏Å‡∏≠‡∏£‡πå</option>
                                <option value="‡∏ò‡∏±‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏ö‡∏¥‡∏£‡πå‡∏î">ü¶Ö ‡∏ò‡∏±‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏ö‡∏¥‡∏£‡πå‡∏î</option>
                            </optgroup>
                            <optgroup label="‚ùÑÔ∏è ‡∏ò‡∏≤‡∏ï‡∏∏‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á (Ice)">
                                <option value="‡πÑ‡∏≠‡∏ã‡πå‡∏ß‡∏π‡∏•‡πå‡∏ü">üê∫ ‡πÑ‡∏≠‡∏ã‡πå‡∏ß‡∏π‡∏•‡πå‡∏ü</option>
                                <option value="‡πÑ‡∏≠‡∏ã‡πå‡πÄ‡∏ö‡∏µ‡∏¢‡∏£‡πå">üêª‚Äç‚ùÑÔ∏è ‡πÑ‡∏≠‡∏ã‡πå‡πÄ‡∏ö‡∏µ‡∏¢‡∏£‡πå</option>
                            </optgroup>
                        </select>
                    </div>
                </div>

                <!-- Normal Tab -->
                <div id="tab-normal" class="tab-content">
                    <input type="file" id="normImageInput" accept="image/*" style="display:none;">

                    <div class="form-group">
                        <label>üìù ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏Å‡∏¥‡∏•</label>
                        <input type="text" id="normName" value="‡∏•‡∏π‡∏Å‡πÑ‡∏ü" oninput="updateAllCards()">
                    </div>

                    <div class="form-group">
                        <label>üìù ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 30 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£)</label>
                        <textarea id="normDesc" rows="2" maxlength="30" oninput="validateDesc('norm')">‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏Å‡∏•‡πâ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</textarea>
                        <div id="normCharCount" class="char-count">0 / 30 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£</div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>‚öîÔ∏è ‡∏î‡∏≤‡πÄ‡∏°‡∏à</label>
                            <input type="number" id="normDamage" value="90" oninput="updateAllCards()">
                        </div>
                        <div class="form-group">
                            <label>üõ°Ô∏è ‡πÇ‡∏•‡πà</label>
                            <input type="number" id="normShield" value="0" oninput="updateAllCards()">
                        </div>
                        <div class="form-group">
                            <label>üíö ‡∏Æ‡∏µ‡∏•</label>
                            <input type="number" id="normHeal" value="0" oninput="updateAllCards()">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>üéØ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</label>
                        <select id="normTarget" onchange="updateAllCards()">
                            <option value="front">‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏∏‡∏î (Front)</option>
                            <option value="back">‡∏´‡∏•‡∏±‡∏á‡∏™‡∏∏‡∏î (Back)</option>
                            <option value="lowest">HP ‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î (Lowest HP)</option>
                            <option value="highest">HP ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î (Highest HP)</option>
                            <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (All)</option>
                            <option value="self">‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á (Self)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>üê≤ ‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á</label>
                        <select id="normOwner" onchange="updateAllCards()">
                            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£ --</option>
                            <optgroup label="üî• ‡∏ò‡∏≤‡∏ï‡∏∏‡πÑ‡∏ü (Fire)">
                                <option value="‡πÑ‡∏ü‡∏£‡πå‡∏î‡∏£‡∏≤‡∏Å‡πâ‡∏≠‡∏ô">üê≤ ‡πÑ‡∏ü‡∏£‡πå‡∏î‡∏£‡∏≤‡∏Å‡πâ‡∏≠‡∏ô</option>
                                <option value="‡πÑ‡∏ü‡∏£‡πå‡∏ü‡πá‡∏≠‡∏Å‡∏ã‡πå">ü¶ä ‡πÑ‡∏ü‡∏£‡πå‡∏ü‡πá‡∏≠‡∏Å‡∏ã‡πå</option>
                            </optgroup>
                            <optgroup label="üíß ‡∏ò‡∏≤‡∏ï‡∏∏‡∏ô‡πâ‡∏≥ (Water)">
                                <option value="‡∏ß‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ï‡∏≠‡∏£‡πå‡∏ó‡∏≠‡∏¢‡∏™‡πå">üê¢ ‡∏ß‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ï‡∏≠‡∏£‡πå‡∏ó‡∏≠‡∏¢‡∏™‡πå</option>
                                <option value="‡∏ß‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏≠‡∏≠‡∏Ñ‡πÇ‡∏ó‡∏õ‡∏±‡∏™">üêô ‡∏ß‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏≠‡∏≠‡∏Ñ‡πÇ‡∏ó‡∏õ‡∏±‡∏™</option>
                            </optgroup>
                            <optgroup label="üåç ‡∏ò‡∏≤‡∏ï‡∏∏‡∏î‡∏¥‡∏ô (Earth)">
                                <option value="‡πÄ‡∏≠‡∏¥‡∏£‡πå‡∏ò‡πÑ‡∏£‡πÇ‡∏ô">ü¶è ‡πÄ‡∏≠‡∏¥‡∏£‡πå‡∏ò‡πÑ‡∏£‡πÇ‡∏ô</option>
                                <option value="‡πÄ‡∏≠‡∏¥‡∏£‡πå‡∏ò‡∏ö‡∏π‡∏•‡∏•‡πå">üêÇ ‡πÄ‡∏≠‡∏¥‡∏£‡πå‡∏ò‡∏ö‡∏π‡∏•‡∏•‡πå</option>
                            </optgroup>
                            <optgroup label="üí® ‡∏ò‡∏≤‡∏ï‡∏∏‡∏•‡∏° (Wind)">
                                <option value="‡∏ß‡∏¥‡∏ô‡∏î‡πå‡∏≠‡∏µ‡πÄ‡∏Å‡∏¥‡∏•">ü¶Ö ‡∏ß‡∏¥‡∏ô‡∏î‡πå‡∏≠‡∏µ‡πÄ‡∏Å‡∏¥‡∏•</option>
                                <option value="‡∏ß‡∏¥‡∏ô‡∏î‡πå‡∏Æ‡∏≠‡∏ß‡πå‡∏Ñ">ü¶ú ‡∏ß‡∏¥‡∏ô‡∏î‡πå‡∏Æ‡∏≠‡∏ß‡πå‡∏Ñ</option>
                            </optgroup>
                            <optgroup label="‚ö° ‡∏ò‡∏≤‡∏ï‡∏∏‡∏™‡∏≤‡∏¢‡∏ü‡πâ‡∏≤ (Electric)">
                                <option value="‡πÑ‡∏•‡∏ó‡πå‡∏ô‡∏¥‡πà‡∏á‡πÑ‡∏ó‡πÄ‡∏Å‡∏≠‡∏£‡πå">üêØ ‡πÑ‡∏•‡∏ó‡πå‡∏ô‡∏¥‡πà‡∏á‡πÑ‡∏ó‡πÄ‡∏Å‡∏≠‡∏£‡πå</option>
                                <option value="‡∏ò‡∏±‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏ö‡∏¥‡∏£‡πå‡∏î">ü¶Ö ‡∏ò‡∏±‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏ö‡∏¥‡∏£‡πå‡∏î</option>
                            </optgroup>
                            <optgroup label="‚ùÑÔ∏è ‡∏ò‡∏≤‡∏ï‡∏∏‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á (Ice)">
                                <option value="‡πÑ‡∏≠‡∏ã‡πå‡∏ß‡∏π‡∏•‡πå‡∏ü">üê∫ ‡πÑ‡∏≠‡∏ã‡πå‡∏ß‡∏π‡∏•‡πå‡∏ü</option>
                                <option value="‡πÑ‡∏≠‡∏ã‡πå‡πÄ‡∏ö‡∏µ‡∏¢‡∏£‡πå">üêª‚Äç‚ùÑÔ∏è ‡πÑ‡∏≠‡∏ã‡πå‡πÄ‡∏ö‡∏µ‡∏¢‡∏£‡πå</option>
                            </optgroup>
                        </select>
                    </div>
                </div>

                <!-- Passive Tab -->
                <div id="tab-passive" class="tab-content">
                    <input type="file" id="passImageInput" accept="image/*" style="display:none;">

                    <div class="form-group">
                        <label>üìù ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏Å‡∏¥‡∏•</label>
                        <input type="text" id="passName" value="‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡πÑ‡∏ü" oninput="updateAllCards()">
                    </div>

                    <div class="form-group">
                        <label>üìù ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 30 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£)</label>
                        <textarea id="passDesc" rows="2" maxlength="30" oninput="validateDesc('pass')">‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÇ‡∏•‡πà‡∏™‡∏∞‡∏™‡∏°‡∏ó‡∏ö‡∏ó‡∏∏‡∏Å‡∏£‡∏≠‡∏ö</textarea>
                        <div id="passCharCount" class="char-count">0 / 30 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£</div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>‚öîÔ∏è ‡∏î‡∏≤‡πÄ‡∏°‡∏à</label>
                            <input type="number" id="passDamage" value="0" oninput="updateAllCards()">
                        </div>
                        <div class="form-group">
                            <label>üõ°Ô∏è ‡πÇ‡∏•‡πà</label>
                            <input type="number" id="passShield" value="40" oninput="updateAllCards()">
                        </div>
                        <div class="form-group">
                            <label>üíö ‡∏Æ‡∏µ‡∏•</label>
                            <input type="number" id="passHeal" value="0" oninput="updateAllCards()">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>üéØ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</label>
                        <select id="passTarget" onchange="updateAllCards()">
                            <option value="front">‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏∏‡∏î (Front)</option>
                            <option value="back">‡∏´‡∏•‡∏±‡∏á‡∏™‡∏∏‡∏î (Back)</option>
                            <option value="lowest">HP ‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î (Lowest HP)</option>
                            <option value="highest">HP ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î (Highest HP)</option>
                            <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (All)</option>
                            <option value="self" selected>‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á (Self)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>üê≤ ‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á</label>
                        <select id="passOwner" onchange="updateAllCards()">
                            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£ --</option>
                            <optgroup label="üî• ‡∏ò‡∏≤‡∏ï‡∏∏‡πÑ‡∏ü (Fire)">
                                <option value="‡πÑ‡∏ü‡∏£‡πå‡∏î‡∏£‡∏≤‡∏Å‡πâ‡∏≠‡∏ô">üê≤ ‡πÑ‡∏ü‡∏£‡πå‡∏î‡∏£‡∏≤‡∏Å‡πâ‡∏≠‡∏ô</option>
                                <option value="‡πÑ‡∏ü‡∏£‡πå‡∏ü‡πá‡∏≠‡∏Å‡∏ã‡πå">ü¶ä ‡πÑ‡∏ü‡∏£‡πå‡∏ü‡πá‡∏≠‡∏Å‡∏ã‡πå</option>
                            </optgroup>
                            <optgroup label="üíß ‡∏ò‡∏≤‡∏ï‡∏∏‡∏ô‡πâ‡∏≥ (Water)">
                                <option value="‡∏ß‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ï‡∏≠‡∏£‡πå‡∏ó‡∏≠‡∏¢‡∏™‡πå">üê¢ ‡∏ß‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ï‡∏≠‡∏£‡πå‡∏ó‡∏≠‡∏¢‡∏™‡πå</option>
                                <option value="‡∏ß‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏≠‡∏≠‡∏Ñ‡πÇ‡∏ó‡∏õ‡∏±‡∏™">üêô ‡∏ß‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏≠‡∏≠‡∏Ñ‡πÇ‡∏ó‡∏õ‡∏±‡∏™</option>
                            </optgroup>
                            <optgroup label="üåç ‡∏ò‡∏≤‡∏ï‡∏∏‡∏î‡∏¥‡∏ô (Earth)">
                                <option value="‡πÄ‡∏≠‡∏¥‡∏£‡πå‡∏ò‡πÑ‡∏£‡πÇ‡∏ô">ü¶è ‡πÄ‡∏≠‡∏¥‡∏£‡πå‡∏ò‡πÑ‡∏£‡πÇ‡∏ô</option>
                                <option value="‡πÄ‡∏≠‡∏¥‡∏£‡πå‡∏ò‡∏ö‡∏π‡∏•‡∏•‡πå">üêÇ ‡πÄ‡∏≠‡∏¥‡∏£‡πå‡∏ò‡∏ö‡∏π‡∏•‡∏•‡πå</option>
                            </optgroup>
                            <optgroup label="üí® ‡∏ò‡∏≤‡∏ï‡∏∏‡∏•‡∏° (Wind)">
                                <option value="‡∏ß‡∏¥‡∏ô‡∏î‡πå‡∏≠‡∏µ‡πÄ‡∏Å‡∏¥‡∏•">ü¶Ö ‡∏ß‡∏¥‡∏ô‡∏î‡πå‡∏≠‡∏µ‡πÄ‡∏Å‡∏¥‡∏•</option>
                                <option value="‡∏ß‡∏¥‡∏ô‡∏î‡πå‡∏Æ‡∏≠‡∏ß‡πå‡∏Ñ">ü¶ú ‡∏ß‡∏¥‡∏ô‡∏î‡πå‡∏Æ‡∏≠‡∏ß‡πå‡∏Ñ</option>
                            </optgroup>
                            <optgroup label="‚ö° ‡∏ò‡∏≤‡∏ï‡∏∏‡∏™‡∏≤‡∏¢‡∏ü‡πâ‡∏≤ (Electric)">
                                <option value="‡πÑ‡∏•‡∏ó‡πå‡∏ô‡∏¥‡πà‡∏á‡πÑ‡∏ó‡πÄ‡∏Å‡∏≠‡∏£‡πå">üêØ ‡πÑ‡∏•‡∏ó‡πå‡∏ô‡∏¥‡πà‡∏á‡πÑ‡∏ó‡πÄ‡∏Å‡∏≠‡∏£‡πå</option>
                                <option value="‡∏ò‡∏±‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏ö‡∏¥‡∏£‡πå‡∏î">ü¶Ö ‡∏ò‡∏±‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏ö‡∏¥‡∏£‡πå‡∏î</option>
                            </optgroup>
                            <optgroup label="‚ùÑÔ∏è ‡∏ò‡∏≤‡∏ï‡∏∏‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á (Ice)">
                                <option value="‡πÑ‡∏≠‡∏ã‡πå‡∏ß‡∏π‡∏•‡πå‡∏ü">üê∫ ‡πÑ‡∏≠‡∏ã‡πå‡∏ß‡∏π‡∏•‡πå‡∏ü</option>
                                <option value="‡πÑ‡∏≠‡∏ã‡πå‡πÄ‡∏ö‡∏µ‡∏¢‡∏£‡πå">üêª‚Äç‚ùÑÔ∏è ‡πÑ‡∏≠‡∏ã‡πå‡πÄ‡∏ö‡∏µ‡∏¢‡∏£‡πå</option>
                            </optgroup>
                        </select>
                    </div>
                </div>

                <!-- Support Tab -->
                <div id="tab-support" class="tab-content">
                    <input type="file" id="suppImageInput" accept="image/*" style="display:none;">

                    <div class="form-group">
                        <label>üìù ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏Å‡∏¥‡∏•</label>
                        <input type="text" id="suppName" value="‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÑ‡∏ü" oninput="updateAllCards()">
                    </div>

                    <div class="form-group">
                        <label>üìù ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 30 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£)</label>
                        <textarea id="suppDesc" rows="2" maxlength="30" oninput="validateDesc('supp')">‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏•‡πà‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô</textarea>
                        <div id="suppCharCount" class="char-count">0 / 30 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£</div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>‚öîÔ∏è ‡∏î‡∏≤‡πÄ‡∏°‡∏à</label>
                            <input type="number" id="suppDamage" value="50" oninput="updateAllCards()">
                        </div>
                        <div class="form-group">
                            <label>üõ°Ô∏è ‡πÇ‡∏•‡πà</label>
                            <input type="number" id="suppShield" value="60" oninput="updateAllCards()">
                        </div>
                        <div class="form-group">
                            <label>üíö ‡∏Æ‡∏µ‡∏•</label>
                            <input type="number" id="suppHeal" value="0" oninput="updateAllCards()">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>üéØ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</label>
                        <select id="suppTarget" onchange="updateAllCards()">
                            <option value="front" selected>‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏∏‡∏î (Front)</option>
                            <option value="back">‡∏´‡∏•‡∏±‡∏á‡∏™‡∏∏‡∏î (Back)</option>
                            <option value="lowest">HP ‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î (Lowest HP)</option>
                            <option value="highest">HP ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î (Highest HP)</option>
                            <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (All)</option>
                            <option value="self">‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á (Self)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>üê≤ ‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á</label>
                        <select id="suppOwner" onchange="updateAllCards()">
                            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£ --</option>
                            <optgroup label="üî• ‡∏ò‡∏≤‡∏ï‡∏∏‡πÑ‡∏ü (Fire)">
                                <option value="‡πÑ‡∏ü‡∏£‡πå‡∏î‡∏£‡∏≤‡∏Å‡πâ‡∏≠‡∏ô">üê≤ ‡πÑ‡∏ü‡∏£‡πå‡∏î‡∏£‡∏≤‡∏Å‡πâ‡∏≠‡∏ô</option>
                                <option value="‡πÑ‡∏ü‡∏£‡πå‡∏ü‡πá‡∏≠‡∏Å‡∏ã‡πå">ü¶ä ‡πÑ‡∏ü‡∏£‡πå‡∏ü‡πá‡∏≠‡∏Å‡∏ã‡πå</option>
                            </optgroup>
                            <optgroup label="üíß ‡∏ò‡∏≤‡∏ï‡∏∏‡∏ô‡πâ‡∏≥ (Water)">
                                <option value="‡∏ß‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ï‡∏≠‡∏£‡πå‡∏ó‡∏≠‡∏¢‡∏™‡πå">üê¢ ‡∏ß‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ï‡∏≠‡∏£‡πå‡∏ó‡∏≠‡∏¢‡∏™‡πå</option>
                                <option value="‡∏ß‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏≠‡∏≠‡∏Ñ‡πÇ‡∏ó‡∏õ‡∏±‡∏™">üêô ‡∏ß‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏≠‡∏≠‡∏Ñ‡πÇ‡∏ó‡∏õ‡∏±‡∏™</option>
                            </optgroup>
                            <optgroup label="üåç ‡∏ò‡∏≤‡∏ï‡∏∏‡∏î‡∏¥‡∏ô (Earth)">
                                <option value="‡πÄ‡∏≠‡∏¥‡∏£‡πå‡∏ò‡πÑ‡∏£‡πÇ‡∏ô">ü¶è ‡πÄ‡∏≠‡∏¥‡∏£‡πå‡∏ò‡πÑ‡∏£‡πÇ‡∏ô</option>
                                <option value="‡πÄ‡∏≠‡∏¥‡∏£‡πå‡∏ò‡∏ö‡∏π‡∏•‡∏•‡πå">üêÇ ‡πÄ‡∏≠‡∏¥‡∏£‡πå‡∏ò‡∏ö‡∏π‡∏•‡∏•‡πå</option>
                            </optgroup>
                            <optgroup label="üí® ‡∏ò‡∏≤‡∏ï‡∏∏‡∏•‡∏° (Wind)">
                                <option value="‡∏ß‡∏¥‡∏ô‡∏î‡πå‡∏≠‡∏µ‡πÄ‡∏Å‡∏¥‡∏•">ü¶Ö ‡∏ß‡∏¥‡∏ô‡∏î‡πå‡∏≠‡∏µ‡πÄ‡∏Å‡∏¥‡∏•</option>
                                <option value="‡∏ß‡∏¥‡∏ô‡∏î‡πå‡∏Æ‡∏≠‡∏ß‡πå‡∏Ñ">ü¶ú ‡∏ß‡∏¥‡∏ô‡∏î‡πå‡∏Æ‡∏≠‡∏ß‡πå‡∏Ñ</option>
                            </optgroup>
                            <optgroup label="‚ö° ‡∏ò‡∏≤‡∏ï‡∏∏‡∏™‡∏≤‡∏¢‡∏ü‡πâ‡∏≤ (Electric)">
                                <option value="‡πÑ‡∏•‡∏ó‡πå‡∏ô‡∏¥‡πà‡∏á‡πÑ‡∏ó‡πÄ‡∏Å‡∏≠‡∏£‡πå">üêØ ‡πÑ‡∏•‡∏ó‡πå‡∏ô‡∏¥‡πà‡∏á‡πÑ‡∏ó‡πÄ‡∏Å‡∏≠‡∏£‡πå</option>
                                <option value="‡∏ò‡∏±‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏ö‡∏¥‡∏£‡πå‡∏î">ü¶Ö ‡∏ò‡∏±‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏ö‡∏¥‡∏£‡πå‡∏î</option>
                            </optgroup>
                            <optgroup label="‚ùÑÔ∏è ‡∏ò‡∏≤‡∏ï‡∏∏‡∏ô‡πâ‡∏≥‡πÅ‡∏Ç‡πá‡∏á (Ice)">
                                <option value="‡πÑ‡∏≠‡∏ã‡πå‡∏ß‡∏π‡∏•‡πå‡∏ü">üê∫ ‡πÑ‡∏≠‡∏ã‡πå‡∏ß‡∏π‡∏•‡πå‡∏ü</option>
                                <option value="‡πÑ‡∏≠‡∏ã‡πå‡πÄ‡∏ö‡∏µ‡∏¢‡∏£‡πå">üêª‚Äç‚ùÑÔ∏è ‡πÑ‡∏≠‡∏ã‡πå‡πÄ‡∏ö‡∏µ‡∏¢‡∏£‡πå</option>
                            </optgroup>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Element configuration
        const elementConfig = {
            fire: {
                gradient: ['#ff6b6b', '#ff8e53'],
                icon: 'üî•',
                emoji: 'üê≤',
                borderColor: ['#ff4444', '#ff8800'],
                iconBg: ['#ff6b6b', '#ff4444']
            },
            water: {
                gradient: ['#4facfe', '#00f2fe'],
                icon: 'üíß',
                emoji: 'üê¢',
                borderColor: ['#2196F3', '#00BCD4'],
                iconBg: ['#4facfe', '#2196F3']
            },
            earth: {
                gradient: ['#8b7355', '#a0826d'],
                icon: 'üåç',
                emoji: 'ü¶è',
                borderColor: ['#795548', '#A1887F'],
                iconBg: ['#8b7355', '#6d5d4b']
            },
            wind: {
                gradient: ['#a0d8f1', '#e0f7ff'],
                icon: 'üí®',
                emoji: 'ü¶Ö',
                borderColor: ['#81D4FA', '#B3E5FC'],
                iconBg: ['#81D4FA', '#4FC3F7']
            },
            electric: {
                gradient: ['#ffd700', '#ffed4e'],
                icon: '‚ö°',
                emoji: 'üêØ',
                borderColor: ['#FFC107', '#FFEB3B'],
                iconBg: ['#ffd700', '#FFA000']
            },
            ice: {
                gradient: ['#87ceeb', '#b0e0e6'],
                icon: '‚ùÑÔ∏è',
                emoji: 'üê∫',
                borderColor: ['#4FC3F7', '#81D4FA'],
                iconBg: ['#87ceeb', '#4FC3F7']
            },
            dark: {
                gradient: ['#4a148c', '#7b1fa2'],
                icon: 'üåô',
                emoji: 'ü¶á',
                borderColor: ['#4a148c', '#6a1b9a'],
                iconBg: ['#6a1b9a', '#4a148c']
            },
            light: {
                gradient: ['#fff9c4', '#ffeb3b'],
                icon: '‚òÄÔ∏è',
                emoji: 'ü¶Ñ',
                borderColor: ['#ffd54f', '#ffeb3b'],
                iconBg: ['#fff9c4', '#ffd54f']
            }
        };

        // Image storage for each card type
        const images = {
            char: { img: null, transform: { scale: 1, x: 0, y: 0 } },
            ult: { img: null, transform: { scale: 1, x: 0, y: 0 } },
            norm: { img: null, transform: { scale: 1, x: 0, y: 0 } },
            pass: { img: null, transform: { scale: 1, x: 0, y: 0 } },
            supp: { img: null, transform: { scale: 1, x: 0, y: 0 } }
        };

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
        function compressImage(img, maxWidth = 500, quality = 0.7) {
            return new Promise((resolve) => {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                
                // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏°‡πà‡πÇ‡∏î‡∏¢‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô
                let width = img.width;
                let height = img.height;
                
                // ‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡∏π‡∏õ‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô maxWidth
                if (width > maxWidth || height > maxWidth) {
                    if (width > height) {
                        height = (height * maxWidth) / width;
                        width = maxWidth;
                    } else {
                        width = (width * maxWidth) / height;
                        height = maxWidth;
                    }
                }
                
                canvas.width = width;
                canvas.height = height;
                
                // ‡∏ß‡∏≤‡∏î‡∏£‡∏π‡∏õ‡∏•‡∏á‡πÉ‡∏ô canvas
                ctx.drawImage(img, 0, 0, width, height);
                
                // ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô Base64 ‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î
                const compressedDataUrl = canvas.toDataURL('image/jpeg', quality);
                
                console.log('üóúÔ∏è ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û:', {
                    original: `${img.width}x${img.height}`,
                    compressed: `${Math.round(width)}x${Math.round(height)}`,
                    originalSize: `${(img.src.length / 1024).toFixed(1)} KB`,
                    compressedSize: `${(compressedDataUrl.length / 1024).toFixed(1)} KB`,
                    reduction: `${((1 - compressedDataUrl.length / img.src.length) * 100).toFixed(1)}%`
                });
                
                resolve(compressedDataUrl);
            });
        }

        // Tab switching
        let currentTab = 'character';
        
        function switchTab(tabName) {
            currentTab = tabName;
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById('tab-' + tabName).classList.add('active');
        }

        // Download current card based on active tab
        function downloadCurrentCard() {
            downloadCard(currentTab);
        }

        // Image upload handlers
        function handleImageUpload(prefix, file) {
            if (!file || !file.type.startsWith('image/')) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û');
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                const img = new Image();
                img.onload = () => {
                    images[prefix].img = img;
                    // Only show controls for character card
                    if (prefix === 'char') {
                        const controls = document.getElementById(prefix + 'ImageControls');
                        if (controls) {
                            controls.style.display = 'flex';
                        }
                    }
                    updateAllCards();
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        // Setup file inputs
        document.getElementById('charImageInput').addEventListener('change', (e) => handleImageUpload('char', e.target.files[0]));
        document.getElementById('ultImageInput').addEventListener('change', (e) => handleImageUpload('ult', e.target.files[0]));
        document.getElementById('normImageInput').addEventListener('change', (e) => handleImageUpload('norm', e.target.files[0]));
        document.getElementById('passImageInput').addEventListener('change', (e) => handleImageUpload('pass', e.target.files[0]));
        document.getElementById('suppImageInput').addEventListener('change', (e) => handleImageUpload('supp', e.target.files[0]));

        // Image transform functions
        function updateCharImage() {
            images.char.transform.scale = document.getElementById('charScaleSlider').value / 100;
            images.char.transform.x = parseInt(document.getElementById('charXSlider').value);
            images.char.transform.y = parseInt(document.getElementById('charYSlider').value);
            document.getElementById('charScaleValue').textContent = document.getElementById('charScaleSlider').value + '%';
            document.getElementById('charXValue').textContent = images.char.transform.x;
            document.getElementById('charYValue').textContent = images.char.transform.y;
            updateAllCards();
        }

        // Reset and remove functions (only for character card)
        function resetCharImage() {
            document.getElementById('charScaleSlider').value = 100;
            document.getElementById('charXSlider').value = 0;
            document.getElementById('charYSlider').value = 0;
            updateCharImage();
        }

        function removeCharImage() {
            images.char.img = null;
            document.getElementById('charImageControls').style.display = 'none';
            document.getElementById('charImageInput').value = '';
            resetCharImage();
        }

        // Description validation
        function validateDesc(prefix) {
            const descInput = document.getElementById(prefix + 'Desc');
            const charCount = document.getElementById(prefix + 'CharCount');
            const currentLength = descInput.value.length;
            
            charCount.textContent = `${currentLength} / 30 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£`;
            
            if (currentLength > 30) {
                charCount.style.color = '#ff4444';
                charCount.textContent = `‚ö†Ô∏è ${currentLength} / 30 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ (‡πÄ‡∏Å‡∏¥‡∏ô‡∏Ç‡∏µ‡∏î‡∏à‡∏≥‡∏Å‡∏±‡∏î!)`;
            } else if (currentLength > 25) {
                charCount.style.color = '#ffaa00';
            } else {
                charCount.style.color = '#ffd700';
            }
            
            updateAllCards();
        }

        // Update all cards
        function updateAllCards() {
            drawCharacterCard();
            drawSkillCard('ultimate', 3);
            drawSkillCard('normal', 1);
            drawSkillCard('passive', 0);
            drawSkillCard('support', 2);
        }

        // Draw character card
        function drawCharacterCard() {
            const canvas = document.getElementById('characterCanvas');
            const ctx = canvas.getContext('2d');
            const element = document.getElementById('charElement').value;
            const nameThai = document.getElementById('charNameThai').value;
            const nameEng = document.getElementById('charNameEng').value.toUpperCase();
            const hp = document.getElementById('charHP').value;
            const atk = document.getElementById('charATK').value;
            const spd = document.getElementById('charSPD').value;
            const config = elementConfig[element];

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Border
            const borderWidth = 12;
            const borderGradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
            borderGradient.addColorStop(0, config.borderColor[0]);
            borderGradient.addColorStop(1, config.borderColor[1]);
            ctx.fillStyle = borderGradient;
            roundRect(ctx, 0, 0, canvas.width, canvas.height, 30, true);

            // Background or image
            if (!images.char.img) {
                const bgGradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
                bgGradient.addColorStop(0, config.gradient[0]);
                bgGradient.addColorStop(1, config.gradient[1]);
                ctx.fillStyle = bgGradient;
                roundRect(ctx, borderWidth, borderWidth, canvas.width - borderWidth * 2, canvas.height - borderWidth * 2, 20, true);
            }

            // Draw image
            drawImage(ctx, images.char, borderWidth, config.emoji);

            // Gradient overlay
            const overlayGradient = ctx.createLinearGradient(0, 850, 0, canvas.height);
            overlayGradient.addColorStop(0, 'rgba(0, 0, 0, 0)');
            overlayGradient.addColorStop(0.4, 'rgba(0, 0, 0, 0.5)');
            overlayGradient.addColorStop(1, 'rgba(0, 0, 0, 0.85)');
            ctx.fillStyle = overlayGradient;
            ctx.fillRect(borderWidth, 850, canvas.width - borderWidth * 2, canvas.height - 850 - borderWidth);

            // Draw elements
            drawElementIcon(ctx, config.icon, config.iconBg, 25, 25);
            drawCharacterName(ctx, nameThai, nameEng);
            drawStats(ctx, hp, atk, spd);
        }

        // Draw skill card
        function drawSkillCard(type, energyCost) {
            const canvasId = type + 'Canvas';
            const canvas = document.getElementById(canvasId);
            const ctx = canvas.getContext('2d');
            
            const prefix = type === 'ultimate' ? 'ult' : type === 'normal' ? 'norm' : type === 'passive' ? 'pass' : 'supp';
            
            // ‡πÉ‡∏ä‡πâ‡∏ò‡∏≤‡∏ï‡∏∏‡∏à‡∏≤‡∏Å‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏Å‡∏¥‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            const element = document.getElementById('charElement').value;
            const skillName = document.getElementById(prefix + 'Name').value;
            const skillDesc = document.getElementById(prefix + 'Desc').value;
            const damage = document.getElementById(prefix + 'Damage').value;
            const shield = document.getElementById(prefix + 'Shield').value;
            const heal = document.getElementById(prefix + 'Heal').value;
            const target = document.getElementById(prefix + 'Target').value;
            
            const config = elementConfig[element];

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Border
            const borderWidth = 12;
            const borderGradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
            borderGradient.addColorStop(0, config.borderColor[0]);
            borderGradient.addColorStop(1, config.borderColor[1]);
            ctx.fillStyle = borderGradient;
            roundRect(ctx, 0, 0, canvas.width, canvas.height, 30, true);

            // Background or image
            if (!images[prefix].img) {
                const bgGradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
                bgGradient.addColorStop(0, config.gradient[0]);
                bgGradient.addColorStop(1, config.gradient[1]);
                ctx.fillStyle = bgGradient;
                roundRect(ctx, borderWidth, borderWidth, canvas.width - borderWidth * 2, canvas.height - borderWidth * 2, 20, true);
            }

            // Draw image
            drawImage(ctx, images[prefix], borderWidth, config.icon);

            // Gradient overlay
            const overlayGradient = ctx.createLinearGradient(0, 800, 0, canvas.height);
            overlayGradient.addColorStop(0, 'rgba(0, 0, 0, 0)');
            overlayGradient.addColorStop(0.4, 'rgba(0, 0, 0, 0.5)');
            overlayGradient.addColorStop(1, 'rgba(0, 0, 0, 0.85)');
            ctx.fillStyle = overlayGradient;
            ctx.fillRect(borderWidth, 800, canvas.width - borderWidth * 2, canvas.height - 800 - borderWidth);

            // Draw elements
            drawEnergyCost(ctx, energyCost);
            drawElementIcon(ctx, config.icon, config.iconBg, canvas.width - 135, 25);
            drawSkillInfoBox(ctx, skillName, damage, shield, heal, skillDesc, target);
        }

        // Helper: Draw image
        function drawImage(ctx, imageData, borderWidth, defaultIcon) {
            const imgX = borderWidth;
            const imgY = borderWidth;
            const imgWidth = 744 - borderWidth * 2;
            const imgHeight = 1039 - borderWidth * 2;

            if (imageData.img) {
                ctx.save();
                
                ctx.beginPath();
                ctx.moveTo(imgX + 20, imgY);
                ctx.lineTo(imgX + imgWidth - 20, imgY);
                ctx.quadraticCurveTo(imgX + imgWidth, imgY, imgX + imgWidth, imgY + 20);
                ctx.lineTo(imgX + imgWidth, imgY + imgHeight - 20);
                ctx.quadraticCurveTo(imgX + imgWidth, imgY + imgHeight, imgX + imgWidth - 20, imgY + imgHeight);
                ctx.lineTo(imgX + 20, imgY + imgHeight);
                ctx.quadraticCurveTo(imgX, imgY + imgHeight, imgX, imgY + imgHeight - 20);
                ctx.lineTo(imgX, imgY + 20);
                ctx.quadraticCurveTo(imgX, imgY, imgX + 20, imgY);
                ctx.closePath();
                ctx.clip();

                const scale = imageData.transform.scale;
                const offsetX = imageData.transform.x;
                const offsetY = imageData.transform.y;
                
                const imgAspect = imageData.img.width / imageData.img.height;
                const areaAspect = imgWidth / imgHeight;
                
                let drawWidth, drawHeight;
                if (imgAspect > areaAspect) {
                    drawHeight = imgHeight * scale;
                    drawWidth = drawHeight * imgAspect;
                } else {
                    drawWidth = imgWidth * scale;
                    drawHeight = drawWidth / imgAspect;
                }
                
                const drawX = imgX + (imgWidth - drawWidth) / 2 + offsetX;
                const drawY = imgY + (imgHeight - drawHeight) / 2 + offsetY;
                
                ctx.drawImage(imageData.img, drawX, drawY, drawWidth, drawHeight);
                ctx.restore();
            } else {
                ctx.font = '200px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.shadowColor = 'rgba(0, 0, 0, 0.5)';
                ctx.shadowBlur = 20;
                ctx.shadowOffsetX = 5;
                ctx.shadowOffsetY = 5;
                ctx.fillText(defaultIcon, 744 / 2, 1039 / 2 - 100);
                ctx.shadowColor = 'transparent';
            }
        }

        // Helper: Draw element icon
        function drawElementIcon(ctx, elementIcon, iconBgColors, x, y) {
            const size = 110;
            
            ctx.shadowColor = 'rgba(0, 0, 0, 0.3)';
            ctx.shadowBlur = 20;
            ctx.shadowOffsetX = 0;
            ctx.shadowOffsetY = 8;
            
            const iconGradient = ctx.createLinearGradient(x, y, x, y + size);
            iconGradient.addColorStop(0, iconBgColors[0]);
            iconGradient.addColorStop(1, iconBgColors[1]);
            
            ctx.fillStyle = iconGradient;
            roundRect(ctx, x, y, size, size, 22, true);
            ctx.shadowColor = 'transparent';
            
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
            ctx.lineWidth = 3;
            roundRect(ctx, x, y, size, size, 22, false, true);
            
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.5)';
            ctx.lineWidth = 1;
            roundRect(ctx, x + 2, y + 2, size - 4, size - 4, 20, false, true);

            ctx.font = '75px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.shadowColor = 'rgba(0, 0, 0, 0.4)';
            ctx.shadowBlur = 8;
            ctx.shadowOffsetX = 0;
            ctx.shadowOffsetY = 3;
            ctx.fillStyle = '#ffffff';
            ctx.fillText(elementIcon, x + size / 2, y + size / 2);
            ctx.shadowColor = 'transparent';
        }

        // Helper: Draw energy cost
        function drawEnergyCost(ctx, cost) {
            const size = 110;
            const x = 25;
            const y = 25;
            
            ctx.shadowColor = 'rgba(0, 0, 0, 0.6)';
            ctx.shadowBlur = 25;
            ctx.shadowOffsetX = 0;
            ctx.shadowOffsetY = 10;
            
            ctx.fillStyle = 'rgba(0, 0, 0, 0.85)';
            ctx.beginPath();
            ctx.arc(x + size/2, y + size/2, size/2, 0, Math.PI * 2);
            ctx.fill();
            ctx.shadowColor = 'transparent';
            
            const gradient = ctx.createLinearGradient(x, y, x, y + size);
            gradient.addColorStop(0, '#ffd700');
            gradient.addColorStop(0.5, '#ffed4e');
            gradient.addColorStop(1, '#ffa500');
            
            ctx.strokeStyle = gradient;
            ctx.lineWidth = 6;
            ctx.beginPath();
            ctx.arc(x + size/2, y + size/2, size/2, 0, Math.PI * 2);
            ctx.stroke();
            
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.4)';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(x + size/2, y + size/2, size/2 - 4, 0, Math.PI * 2);
            ctx.stroke();
            
            ctx.font = 'bold 75px Kanit, sans-serif';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.shadowColor = 'rgba(0, 0, 0, 0.8)';
            ctx.shadowBlur = 10;
            ctx.shadowOffsetX = 2;
            ctx.shadowOffsetY = 2;
            
            const textGradient = ctx.createLinearGradient(x, y, x, y + size);
            textGradient.addColorStop(0, '#ffffff');
            textGradient.addColorStop(1, '#ffd700');
            
            ctx.fillStyle = textGradient;
            ctx.fillText(cost, x + size/2, y + size/2);
            ctx.shadowColor = 'transparent';
        }

        // Helper: Draw character name
        function drawCharacterName(ctx, nameThai, nameEng) {
            const y = 920;
            
            ctx.font = '600 60px Kanit, sans-serif';
            ctx.fillStyle = '#ffffff';
            ctx.textAlign = 'center';
            ctx.shadowColor = 'rgba(0, 0, 0, 0.8)';
            ctx.shadowBlur = 12;
            ctx.shadowOffsetX = 3;
            ctx.shadowOffsetY = 3;
            ctx.fillText(nameThai, 744 / 2, y);
            ctx.shadowColor = 'transparent';
        }

        // Helper: Draw stats
        function drawStats(ctx, hp, atk, spd) {
            const y = 985;
            
            ctx.font = '600 46px Kanit, sans-serif';
            ctx.textAlign = 'center';
            ctx.shadowColor = 'rgba(0, 0, 0, 0.8)';
            ctx.shadowBlur = 10;
            ctx.shadowOffsetX = 3;
            ctx.shadowOffsetY = 3;

            const statsText = `‚ù§Ô∏è ${hp}  ‚öîÔ∏è ${atk}  ‚ö° ${spd}`;
            ctx.fillStyle = '#ffffff';
            ctx.fillText(statsText, 744 / 2, y);
            ctx.shadowColor = 'transparent';
        }

        // Helper: Draw skill info box
        function drawSkillInfoBox(ctx, skillName, damage, shield, heal, desc, target) {
            const boxX = 30;
            const boxY = 780;
            const boxWidth = 744 - 60;
            const boxHeight = 240;
            
            ctx.shadowColor = 'rgba(0, 0, 0, 0.5)';
            ctx.shadowBlur = 20;
            ctx.shadowOffsetX = 0;
            ctx.shadowOffsetY = 8;
            
            ctx.fillStyle = 'rgba(0, 0, 0, 0.75)';
            roundRect(ctx, boxX, boxY, boxWidth, boxHeight, 15, true);
            ctx.shadowColor = 'transparent';
            
            const borderGradient = ctx.createLinearGradient(boxX, boxY, boxX, boxY + boxHeight);
            borderGradient.addColorStop(0, 'rgba(255, 215, 0, 0.8)');
            borderGradient.addColorStop(1, 'rgba(255, 165, 0, 0.8)');
            
            ctx.strokeStyle = borderGradient;
            ctx.lineWidth = 3;
            roundRect(ctx, boxX, boxY, boxWidth, boxHeight, 15, false, true);
            
            // Reset stroke style to prevent white lines under text
            ctx.strokeStyle = 'transparent';
            ctx.lineWidth = 0;
            
            const lineSpacing = 70;
            let currentY = boxY + 60;
            
            // Line 1: Skill name + stats
            ctx.font = '600 68px Kanit, sans-serif';
            ctx.fillStyle = '#ffffff';
            ctx.textAlign = 'center';
            ctx.shadowColor = 'rgba(0, 0, 0, 0.8)';
            ctx.shadowBlur = 10;
            ctx.shadowOffsetX = 2;
            ctx.shadowOffsetY = 2;
            
            let statsText = '';
            if (parseInt(damage) > 0) statsText += ` ‚öîÔ∏è ${damage}`;
            if (parseInt(shield) > 0) statsText += ` üõ°Ô∏è ${shield}`;
            if (parseInt(heal) > 0) statsText += ` üíö ${heal}`;
            
            ctx.fillText(`${skillName}${statsText}`, 744 / 2, currentY);
            currentY += lineSpacing;
            
            // Line 2: Description
            ctx.font = '400 42px Kanit, sans-serif';
            ctx.fillStyle = '#e0e0e0';
            if (desc && desc.trim()) {
                const displayDesc = desc.length > 30 ? desc.substring(0, 30) + '...' : desc;
                ctx.fillText(displayDesc, 744 / 2, currentY);
            }
            currentY += lineSpacing;
            
            // Line 3: Target
            const targetText = {
                'front': '‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡∏®‡∏±‡∏ï‡∏£‡∏π‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏∏‡∏î',
                'back': '‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡∏®‡∏±‡∏ï‡∏£‡∏π‡∏´‡∏•‡∏±‡∏á‡∏™‡∏∏‡∏î',
                'lowest': '‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡∏®‡∏±‡∏ï‡∏£‡∏π HP ‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î',
                'highest': '‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡∏®‡∏±‡∏ï‡∏£‡∏π HP ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î',
                'all': '‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡∏®‡∏±‡∏ï‡∏£‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î',
                'self': '‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á'
            };
            
            ctx.font = '600 45px Kanit, sans-serif';
            ctx.fillStyle = '#ffd700';
            ctx.fillText(`üéØ ${targetText[target]}`, 744 / 2, currentY);
            ctx.shadowColor = 'transparent';
        }

        // Helper: Round rectangle
        function roundRect(ctx, x, y, width, height, radius, fill, stroke) {
            ctx.beginPath();
            ctx.moveTo(x + radius, y);
            ctx.lineTo(x + width - radius, y);
            ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
            ctx.lineTo(x + width, y + height - radius);
            ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
            ctx.lineTo(x + radius, y + height);
            ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
            ctx.lineTo(x, y + radius);
            ctx.quadraticCurveTo(x, y, x + radius, y);
            ctx.closePath();
            if (fill) ctx.fill();
            if (stroke) ctx.stroke();
        }

        // Download functions
        function downloadCard(type) {
            const canvasId = type === 'character' ? 'characterCanvas' : type + 'Canvas';
            const canvas = document.getElementById(canvasId);
            const link = document.createElement('a');
            link.download = `${type}-card-${Date.now()}.png`;
            link.href = canvas.toDataURL('image/png');
            link.click();
        }

        function downloadAllCards() {
            const types = ['character', 'ultimate', 'normal', 'passive', 'support'];
            types.forEach((type, index) => {
                setTimeout(() => {
                    downloadCard(type);
                }, index * 500);
            });
        }

        // Save to System
        function saveToSystem() {
            console.log('üîµ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...');
            console.log('üîç ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö window.opener:', window.opener ? '‡∏°‡∏µ' : '‡πÑ‡∏°‡πà‡∏°‡∏µ');
            console.log('üîç ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö window.parent:', window.parent ? '‡∏°‡∏µ' : '‡πÑ‡∏°‡πà‡∏°‡∏µ');
            console.log('üîç ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö isInIframe:', window.self !== window.top);
            console.log('üîç window.opener closed?', window.opener ? window.opener.closed : 'N/A');
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô
            const charName = document.getElementById('charNameThai').value.trim();
            console.log('üìù ‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£:', charName);
            if (!charName) {
                alert('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£');
                return;
            }
            
            // ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            const cardData = {
                character: {
                    element: document.getElementById('charElement').value,
                    nameThai: document.getElementById('charNameThai').value,
                    nameEng: document.getElementById('charNameEng').value,
                    hp: parseInt(document.getElementById('charHP').value),
                    attack: parseInt(document.getElementById('charATK').value),
                    speed: parseInt(document.getElementById('charSPD').value),
                    image: images.char.img ? images.char.img.src : null,
                    imageTransform: images.char.transform
                },
                skills: {
                    ultimate: {
                        name: document.getElementById('ultName').value || 'Ultimate Skill',
                        description: document.getElementById('ultDesc').value || 'Ultimate attack',
                        damage: parseInt(document.getElementById('ultDamage').value) || 200,
                        shield: parseInt(document.getElementById('ultShield').value) || 0,
                        heal: parseInt(document.getElementById('ultHeal').value) || 0,
                        target: document.getElementById('ultTarget').value || 'front',
                        owner: document.getElementById('ultOwner').value || '',
                        image: images.ult.img ? images.ult.img.src : null,
                        energyCost: 3,
                        type: 'ultimate'
                    },
                    normal: {
                        name: document.getElementById('normName').value || 'Normal Skill',
                        description: document.getElementById('normDesc').value || 'Normal attack',
                        damage: parseInt(document.getElementById('normDamage').value) || 90,
                        shield: parseInt(document.getElementById('normShield').value) || 0,
                        heal: parseInt(document.getElementById('normHeal').value) || 0,
                        target: document.getElementById('normTarget').value || 'front',
                        owner: document.getElementById('normOwner').value || '',
                        image: images.norm.img ? images.norm.img.src : null,
                        energyCost: 1,
                        type: 'normal'
                    },
                    passive: {
                        name: document.getElementById('passName').value || 'Passive Skill',
                        description: document.getElementById('passDesc').value || 'Passive effect',
                        damage: parseInt(document.getElementById('passDamage').value) || 0,
                        shield: parseInt(document.getElementById('passShield').value) || 40,
                        heal: parseInt(document.getElementById('passHeal').value) || 0,
                        target: document.getElementById('passTarget').value || 'self',
                        owner: document.getElementById('passOwner').value || '',
                        image: images.pass.img ? images.pass.img.src : null,
                        energyCost: 0,
                        type: 'passive'
                    },
                    support: {
                        name: document.getElementById('suppName').value || 'Support Skill',
                        description: document.getElementById('suppDesc').value || 'Support effect',
                        damage: parseInt(document.getElementById('suppDamage').value) || 50,
                        shield: parseInt(document.getElementById('suppShield').value) || 60,
                        heal: parseInt(document.getElementById('suppHeal').value) || 0,
                        target: document.getElementById('suppTarget').value || 'front',
                        owner: document.getElementById('suppOwner').value || '',
                        image: images.supp.img ? images.supp.img.src : null,
                        energyCost: 2,
                        type: 'support'
                    }
                },
                timestamp: new Date().toISOString()
            };

            console.log('üì¶ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å:', cardData);

            // ‡∏î‡∏∂‡∏á‡∏£‡∏π‡∏õ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏ó‡∏µ‡πà render ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏à‡∏≤‡∏Å Canvas
            console.log('üé® ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏£‡∏π‡∏õ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏à‡∏≤‡∏Å Canvas...');
            const characterCanvas = document.getElementById('characterCanvas');
            const ultimateCanvas = document.getElementById('ultimateCanvas');
            const normalCanvas = document.getElementById('normalCanvas');
            const passiveCanvas = document.getElementById('passiveCanvas');
            const supportCanvas = document.getElementById('supportCanvas');
            
            const characterCardImage = characterCanvas.toDataURL('image/png');
            const ultimateCardImage = ultimateCanvas.toDataURL('image/png');
            const normalCardImage = normalCanvas.toDataURL('image/png');
            const passiveCardImage = passiveCanvas.toDataURL('image/png');
            const supportCardImage = supportCanvas.toDataURL('image/png');
            
            console.log('‚úÖ ‡∏î‡∏∂‡∏á‡∏£‡∏π‡∏õ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (5 ‡πÉ‡∏ö)');

            // ‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
            console.log('üóúÔ∏è ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û...');
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á Image objects ‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            const loadImage = (src) => {
                return new Promise((resolve) => {
                    const img = new Image();
                    img.onload = () => resolve(img);
                    img.src = src;
                });
            };
            
            Promise.all([
                loadImage(characterCardImage),
                loadImage(ultimateCardImage),
                loadImage(normalCardImage),
                loadImage(passiveCardImage),
                loadImage(supportCardImage)
            ]).then(([charImg, ultImg, normImg, passImg, suppImg]) => {
                return Promise.all([
                    compressImage(charImg, 500, 0.7),
                    compressImage(ultImg, 500, 0.7),
                    compressImage(normImg, 500, 0.7),
                    compressImage(passImg, 500, 0.7),
                    compressImage(suppImg, 500, 0.7)
                ]);
            }).then(([compressedChar, compressedUlt, compressedNorm, compressedPass, compressedSupp]) => {
                console.log('‚úÖ ‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏£‡∏π‡∏õ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß');
                
                // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏π‡∏õ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏ó‡∏µ‡πà‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡πÅ‡∏•‡πâ‡∏ß
                cardData.character.image = compressedChar;
                cardData.skills.ultimate.image = compressedUlt;
                cardData.skills.normal.image = compressedNorm;
                cardData.skills.passive.image = compressedPass;
                cardData.skills.support.image = compressedSupp;

                // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏™‡πà‡∏á‡πÑ‡∏õ
                const cardDataToSend = {
                    character: {
                        ...cardData.character,
                        image: compressedChar
                    },
                    skills: {
                        ultimate: { ...cardData.skills.ultimate, image: compressedUlt },
                        normal: { ...cardData.skills.normal, image: compressedNorm },
                        passive: { ...cardData.skills.passive, image: compressedPass },
                        support: { ...cardData.skills.support, image: compressedSupp }
                    },
                    timestamp: cardData.timestamp
                };

                // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á localStorage
                try {
                    const savedCards = JSON.parse(localStorage.getItem('savedCards') || '[]');
                    savedCards.push(cardDataToSend);
                    localStorage.setItem('savedCards', JSON.stringify(savedCards));
                    console.log('üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á localStorage ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡∏£‡∏ß‡∏°‡∏£‡∏π‡∏õ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)');
                } catch (e) {
                    console.warn('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á localStorage:', e);
                }

                // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡πà‡∏≠
                sendDataToAdminPanel(cardDataToSend, cardData);
            }).catch(error => {
                console.error('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏£‡∏π‡∏õ‡∏Å‡∏≤‡∏£‡πå‡∏î:', error);
                alert('‚ö†Ô∏è ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏£‡∏π‡∏õ‡∏Å‡∏≤‡∏£‡πå‡∏î\n\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á');
            });
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Admin Panel
        function sendDataToAdminPanel(cardDataToSend, cardData) {

            // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
            const isInIframe = window.self !== window.top;
            
            console.log('üîç ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°:');
            console.log('  - isInIframe:', isInIframe);
            console.log('  - window.parent:', window.parent);
            console.log('  - window.opener:', window.opener);
            
            if (isInIframe) {
                // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á parent window (iframe)
                console.log('üì§ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Admin Panel (iframe)...');
                try {
                    window.parent.postMessage({
                        type: 'CARD_DATA_SAVED',
                        data: cardDataToSend }, '*');
                    console.log('‚úÖ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à - Admin Panel ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß');
                    console.log('ÔøΩ Message ‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á:', { type: 'CARD_DATA_SAVED', data: cardDataToSend });
                    
                    // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô
                    setTimeout(() => {
                        alert('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!\n\n' +
                              'üì¶ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á Admin Panel ‡πÅ‡∏•‡πâ‡∏ß\n' +
                              'üëâ ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° "‚úï ‡∏õ‡∏¥‡∏î" ‡πÅ‡∏•‡∏∞‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πá‡∏ö "üë• ‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£"\n' +
                              'üéâ ‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£ "' + cardData.character.nameThai + '" ‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£\n\n' +
                              'üíæ ‡πÑ‡∏ü‡∏•‡πå JSON ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥');
                    }, 100);
                } catch (error) {
                    console.error('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:', error);
                    alert('‚ö†Ô∏è ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•\n\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏•‡πå JSON ‡∏ó‡∏µ‡πà‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î');
                }
            } else if (window.opener && !window.opener.closed) {
                // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á window.opener (popup window)
                console.log('üì§ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Admin Panel (popup)...');
                try {
                    window.opener.postMessage({
                        type: 'CARD_DATA_SAVED',
                        data: cardDataToSend }, '*');
                    console.log('‚úÖ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à - Admin Panel ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß');
                    
                    // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô
                    alert('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!\n\n' +
                          'ÔøΩ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á Admin Panel ‡πÅ‡∏•‡πâ‡∏ß\n' +
                          'üëâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏µ‡πà Admin Panel > ‡πÅ‡∏ó‡πá‡∏ö "üë• ‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£"\n' +
                          'üéâ ‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£ "' + cardData.character.nameThai + '" ‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£\n\n' +
                          'üíæ ‡πÑ‡∏ü‡∏•‡πå JSON ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥');
                } catch (error) {
                    console.error('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:', error);
                    alert('‚ö†Ô∏è ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•\n\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏•‡πå JSON ‡∏ó‡∏µ‡πà‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î');
                }
            } else {
                console.warn('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ - ‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡∏à‡∏≤‡∏Å Admin Panel');
                console.log('üí° ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏¥‡∏î Card Generator ‡∏à‡∏≤‡∏Å‡πÅ‡∏ó‡πá‡∏ö "üé¥ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏û‡∏¥‡∏°‡∏û‡πå" ‡πÉ‡∏ô Admin Panel');
                
                // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥
                alert('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Admin Panel\n\n' +
                      'üìå ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:\n' +
                      '1. ‡πÄ‡∏õ‡∏¥‡∏î Admin Panel ‡πÉ‡∏ô‡πÄ‡∏Å‡∏°\n' +
                      '2. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πá‡∏ö "üé¥ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏û‡∏¥‡∏°‡∏û‡πå"\n' +
                      '3. ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° "üöÄ ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î"\n\n' +
                      'üíæ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå JSON ‡∏™‡∏≥‡∏£‡∏≠‡∏á\n' +
                      '‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á‡πÑ‡∏î‡πâ');
            }
            
            // Export ‡πÄ‡∏õ‡πá‡∏ô JSON (‡∏™‡∏≥‡∏£‡∏≠‡∏á)
            const dataStr = JSON.stringify(cardData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `card-data-${cardData.character.nameEng.replace(/\s+/g, '-')}-${Date.now()}.json`;
            link.click();
            URL.revokeObjectURL(url);
            console.log('üì• Export JSON ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
        }

        // Check connection status on load
        function checkConnectionStatus() {
            const statusDiv = document.getElementById('connectionStatus');
            const statusIcon = document.getElementById('statusIcon');
            const statusText = document.getElementById('statusText');
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô iframe ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
            const isInIframe = window.self !== window.top;
            
            if (isInIframe) {
                statusDiv.style.background = 'linear-gradient(135deg, #48bb78 0%, #38a169 100%)';
                statusDiv.style.color = '#fff';
                statusIcon.textContent = '‚úÖ';
                statusText.textContent = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Admin Panel ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à - ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
                console.log('‚úÖ ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÉ‡∏ô iframe - ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Admin Panel ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
            } else if (window.opener && !window.opener.closed) {
                statusDiv.style.background = 'linear-gradient(135deg, #48bb78 0%, #38a169 100%)';
                statusDiv.style.color = '#fff';
                statusIcon.textContent = '‚úÖ';
                statusText.textContent = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Admin Panel ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à - ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
                console.log('‚úÖ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Admin Panel ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (window.opener)');
            } else {
                statusDiv.style.background = 'linear-gradient(135deg, #f6ad55 0%, #ed8936 100%)';
                statusDiv.style.color = '#fff';
                statusIcon.textContent = '‚ö†Ô∏è';
                statusText.textContent = '‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡∏à‡∏≤‡∏Å Admin Panel - ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡πÅ‡∏ó‡πá‡∏ö "üé¥ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏û‡∏¥‡∏°‡∏û‡πå"';
                console.warn('‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Admin Panel');
                console.log('üí° ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ: ‡πÄ‡∏õ‡∏¥‡∏î Admin Panel > ‡πÅ‡∏ó‡πá‡∏ö "üé¥ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏û‡∏¥‡∏°‡∏û‡πå" > ‡∏Ñ‡∏•‡∏¥‡∏Å "üöÄ ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î"');
            }
        }

        // Wait for fonts to load before rendering
        document.fonts.ready.then(() => {
            console.log('‚úÖ Fonts loaded successfully');
            updateAllCards();
            checkConnectionStatus();
        });

        // Initialize character counts
        setTimeout(() => {
            validateDesc('ult');
            validateDesc('norm');
            validateDesc('pass');
            validateDesc('supp');
        }, 100);
    </script>
</body>
</html>

